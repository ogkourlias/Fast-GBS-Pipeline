"""
Main rule to run the pipeline.
"""

# Imports
configfile: "config/config.yaml"
include: "rules/preprocessing.smk"
include: "rules/demultiplex.smk"

# Parameters
output_dir = config["demultiplexed"]
barcodes = config["barcodes"]
trimmed = config["trimmed"]
barcode_ids = [line.split('\t')[0] for line in open(config["barcodes"], "r")]

rule all:
    input:
        expand([trimmed + "{id}_1.fastq", trimmed + "{id}_2.fastq"], id=barcode_ids)

